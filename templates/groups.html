<!DOCTYPE html>
<html lang="en">
    <head>
        <title>BeRD</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <script>const IP = "http://140.238.240.27:8000"</script>

        <style data-tag="reset-style-sheet">
html {  line-height: 1.15;}body {  margin: 0;}* {  box-sizing: border-box;  border-width: 0;  border-style: solid;}p,li,ul,pre,div,h1,h2,h3,h4,h5,h6,figure,blockquote,figcaption {  margin: 0;  padding: 0;}button {  background-color: transparent;}button,input,optgroup,select,textarea {  font-family: inherit;  font-size: 100%;  line-height: 1.15;  margin: 0;}button,select {  text-transform: none;}button,[type="button"],[type="reset"],[type="submit"] {  -webkit-appearance: button;}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner {  border-style: none;  padding: 0;}button:-moz-focus,[type="button"]:-moz-focus,[type="reset"]:-moz-focus,[type="submit"]:-moz-focus {  outline: 1px dotted ButtonText;}a {  color: inherit;  text-decoration: inherit;}input {  padding: 2px 4px;}img {  display: block;}html { scroll-behavior: smooth  }
        </style>
        <style data-tag="default-style-sheet">
html {
    font-family: Inter;
    font-size: 16px;
}

        body {
            font-weight: 400;
            font-style:normal;
            text-decoration: none;
            text-transform: none;
            letter-spacing: normal;
            line-height: 1.15;
            color: var(--dl-color-gray-black);
            background-color: var(--dl-color-gray-white);

        }
        </style>
        <link
        rel="stylesheet"
        href="https://unpkg.com/animate.css@4.1.1/animate.css"
        />
        <link
        rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&amp;display=swap"
        data-tag="font"
        />
        <link
        rel="stylesheet"
        href="https://unpkg.com/@teleporthq/teleport-custom-scripts/dist/style.css"
        />
        <!-- Head Custom Code -->

        <!-- Sidebar class and function -->
        <style>
.app-sidebar.closed{
    position: absolute;
    transform: translateX(-600px);
}
        </style>

        <!-- Scrollbar CSS -->
        <style>
::-webkit-scrollbar{
    background: transparent;
    height: 6px;
    width: 6px;
}
        ::-webkit-scrollbar-thumb{
            background-color: gray;
            border-radius: 100px;
        }
        </style>

    <!--    <script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>-->

    </head>
    <body style="user-select: none">
        <link rel="stylesheet" href="{{ url_for('static', path='/styles.css') }}" />
        <div>
            <link href="{{ url_for('static', path='/main.css') }}" rel="stylesheet" />

            <div class="app-container">
                <div class="app-decoration"></div>
                <svg onclick="toggleSidebar()" viewBox="0 0 1024 1024" class="app-open-sidebar">
                    <path d="M426 256l256 256-256 256-60-60 196-196-196-196z"></path>
                </svg>
                <!--        <svg onclick="reload_status()" viewBox="0 0 1024 1024" class="app-refresh">-->
                <!--            <path d="M754 270l100-100v300h-300l138-138q-76-76-180-76-106 0-181 75t-75 181 75 181 181 75q74 0 145-50t97-120h88q-28 112-120 184t-210 72q-140 0-240-100t-100-242 100-242 240-100q60 0 131 29t111 71z"></path>-->
                <!--        </svg>-->
                <div class="app-root">
                    <div class="app-sidebar">
                        <svg onclick="toggleSidebar()" viewBox="0 0 1024 1024" class="app-close-sidebar">
                            <path d="M225.835 286.165l225.835 225.835-225.835 225.835c-16.683 16.683-16.683 43.691 0 60.331s43.691 16.683 60.331 0l225.835-225.835 225.835 225.835c16.683 16.683 43.691 16.683 60.331 0s16.683-43.691 0-60.331l-225.835-225.835 225.835-225.835c16.683-16.683 16.683-43.691 0-60.331s-43.691-16.683-60.331 0l-225.835 225.835-225.835-225.835c-16.683-16.683-43.691-16.683-60.331 0s-16.683 43.691 0 60.331z"></path>
                        </svg>
                        <div class="app-nav-item">
                            <span class="app-nav-item-text">Home</span>
                        </div>
                        <div class="app-nav-item">
                            <span class="app-nav-item-text">Status</span>
                        </div>
                        <div class="app-nav-item">
                            <span class="app-nav-item-text"><a href="/hosts">Hosts</a></span>
                        </div>
                        <div class="app-nav-item">
                            <span class="app-nav-item-text"><a href="/groups">Groups</a></span>
                        </div>
                    </div>
                    <div class="app-main">
                        <header data-role="Header" class="app-header">
                            <img alt="logo" class="app-image"
                            src="https://presentation-website-assets.teleporthq.io/logos/logo.png"
                            />
                        </header>
                        <div class="app-content">
                            <div class="app-status">
                                <div class="app-status-header">
                                    <span class="app-heading-text">
                                        <span>Groups</span>  <br/>
                                    </span>
                                    <div class="app-group-new-div" onclick="createNewGroup()">
                                        <svg viewBox="0 0 1024 1024" class="app-group-new-icon">
                                            <path d="M992 384h-352v-352c0-17.672-14.328-32-32-32h-192c-17.672 0-32 14.328-32 32v352h-352c-17.672 0-32 14.328-32 32v192c0 17.672 14.328 32 32 32h352v352c0 17.672 14.328 32 32 32h192c17.672 0 32-14.328 32-32v-352h352c17.672 0 32-14.328 32-32v-192c0-17.672-14.328-32-32-32z"></path>
                                        </svg>
                                        <span class="app-group-new-text">New</span>
                                    </div>
                                </div>
                                <div class="app-groupdiv">
                                    <table>
                                        <thead>
                                            <tr>
                                                <th id="group-table-name">Name</th>
                                                <th id="group-table-state">Status</th>
                                                <th id="group-table-uuid">UUID</th>
                                                <th id="group-table-created">Created</th>
                                            </tr>
                                        </thead>
                                        <tbody id="data-output-status">
                                            <!-- To be populated by js -->
                                        </tbody>
                                    </table>
                                </div>
                                <div class="app-status-footer"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script>
            function toggleSidebar() {
                document.querySelector('.app-sidebar')
                    .classList.toggle('closed');
            }

            function resizeFn() {
                let width = window.innerWidth;
                if (width <= 1300){
                    document.querySelector('.app-sidebar')
                        .classList.add('closed');
                }else{
                    document.querySelector('.app-sidebar')
                        .classList.remove('closed');
                }
            }
            window.onresize = resizeFn;
            resizeFn();
        </script>

        <script>
            function createNewGroup() {
                fetch(IP + '/api/new_group', {
                    method: 'POST',
                })
                    .then(function (response) {
                        reload_groups()
                    })
            }


            function reload_groups() {
                fetch(IP + "/api/all_groups")
                    .then(function (response) {
                        return response.json()
                    })
                    .then(function (groups) {
                        let placeholder = document.getElementById('data-output-status');
                        let out = "";
                        let icon_off = `
                            <svg viewBox="0 0 877.7142857142857 1024" class="home-status-icon" style="fill: var(--dl-color-danger-700); margin-top: 0px; width: 10px; height: 10px">
                            <path d="M877.714 512c0 242.286-196.571 438.857-438.857 438.857s-438.857-196.571-438.857-438.857 196.571-438.857 438.857-438.857 438.857 196.571 438.857 438.857z"></path>
                            </svg>
                            `;
                        let icon_on = `
                            <svg viewBox="0 0 877.7142857142857 1024" class="home-status-icon" style="fill: var(--dl-color-success-700); margin-top: 0px; width: 10px; height: 10px">
                            <path d="M877.714 512c0 242.286-196.571 438.857-438.857 438.857s-438.857-196.571-438.857-438.857 196.571-438.857 438.857-438.857 438.857 196.571 438.857 438.857z"></path>
                            </svg>
                            `;

                        for (let group of groups){
                            out += `
                                <tr onclick="document.location = '/group/${group.uuid}/info'" style="cursor: pointer; height: 46px">
                                <td>${group.name}</td>
                                <td>${icon_on} ${group.status.on}&nbsp;&nbsp;${icon_off} ${group.status.off}</td>
                                <td style="font-family: monospace;">${group.uuid}</td>
                                <td style="font-family: monospace;">${group.timeCreated.replace("T", " ").slice(0, -7)}</td>
                                </tr>
                                `;
                        }
                        placeholder.innerHTML = out;
                    })
            }

            function repeat_reload_groups() {
                reload_groups()
                groups_refresh_timer = setTimeout(repeat_reload_groups, 5000)
            }
            repeat_reload_groups()
        </script>
    </body>
</html>
